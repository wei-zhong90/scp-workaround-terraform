This is a copy from Keith Kirk's open source project
